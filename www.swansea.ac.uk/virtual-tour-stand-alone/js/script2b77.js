/*! Swansea University - VT Updates - 985, Population v7b, 20.3.2020 */
!function(e,t,i){"use strict";function n(){q.map(function(e){if(e.dimensions){var t=e.filename?"img/maps/"+e.filename:"img/maps/"+e.id+"-park-campus-aerial.jpg",i=document.getElementById("map-"+e.id);i&&(i.style.backgroundImage="url('"+t+"')",Draggable.create("#map-"+e.id,{type:"x,y",zIndexBoost:!1,edgeResistance:.85,bounds:"#campus-"+e.id,throwProps:!0,minimumMovement:6}))}}),D(".side-nav").map(function(e){var t=e.childElementCount;e.classList.add("count"+t)}),a("ug","undergraduate"),a("pg","postgraduate"),u()}function a(e,t){if(U[e]){var i=document.getElementById("subject-"+t);i&&U[e].map(function(t){var n=document.createElement("option");n.id=e+"_"+_(t.heading[0]),n.value=e+"_"+_(t.heading[0]),n.dataset.english=t.heading[0],n.dataset.cymraeg=t.heading[1],i.appendChild(n)})}}function s(){var i=""!==A("s")?A("s"):"start";e.currentScreen=i;var n=""!==A("f")&&A("f"),a=""!==A("g")&&A("g"),s=""!==A("c")&&A("c");V(),n?e.activeFilterObj&&"all"!==e.activeFilterObj||d(n):d(),e.whatsNextVisible&&S(),e.iframeWindowVisible&&k(),e.setCategory||(e.setCategory="academic",L(t("#first-cat .cat-title.default").data())),"start"===i||"interest"===i?(t("#screen-info").hide(),t(".screen-label").text("")):t("#screen-info").show(),"start"===i?e.startVisible||(document.getElementById("subject-undergraduate").selectedIndex=0,document.getElementById("subject-postgraduate").selectedIndex=0,t("#start-screen").show(),H(),e.startVisible=!0):e.startVisible&&(t("#start-screen").hide(),W(),e.startVisible=!1),"interest"==i?e.subjectSelVisible||(F("start"),document.getElementById("subject-undergraduate").selectedIndex=0,document.getElementById("subject-postgraduate").selectedIndex=0,t("#subject-select").addClass("show"),e.subjectSelVisible=!0):e.subjectSelVisible&&(t("#subject-select").removeClass("show"),e.subjectSelVisible=!1),"campus"!=i||e.campusSelVisible?e.campusSelVisible&&(t("#campus-select-container").removeClass("show"),e.campusSelVisible=!1):(F("interest"),t("#campus-select-container").addClass("show"),t(".screen-label").text(X.campus_select_title[ne]),e.campusSelVisible=!0),"singleton"==i||"bay"==i||"accommodation"==i?(F("campus"),e.campusVisible&&e.campusVisible!==i&&t(".campus-screen").removeClass("show"),t("#campus-"+i).addClass("show"),t(".screen-label").text(P(q,i).heading[ne]),e.campusVisible=i):e.campusVisible&&(t(".campus-screen").removeClass("show"),e.campusVisible=!1),a?(F(i),"accommodation"==i&&(e.setCategory="accommodation",L({english:X.accommodation[0],cymraeg:X.accommodation[1]})),b(a,s)):(e.setCategory=!1,e.contentOpen&&T(),j("hide")),te=!1}function o(){t("#wn-open").click(O),t("#wn-back").click(S),D(".subject-select-el").map(function(e){e.addEventListener("change",function(){c(this.value)})}),D(".tile").map(function(e){e.addEventListener("mouseenter",function(){this.classList.add("hover")}),e.addEventListener("mouseleave",function(){this.classList.remove("hover")})}),t(".iframe-window-open").click(I),t("#iframe-window-close").click(k),t("#slideout-toggle").click(function(e){e.preventDefault(),j()}),t(".touch-content-toggle").click(function(e){e.preventDefault(),t(this).hasClass("disabled")||m(this.dataset.type)}),t(".side-nav li").click(function(){e.setCategory=this.dataset.showcat,L(this.querySelector(".side-nav-tt").dataset)}),t(".historyjs-link").click(function(e){e.preventDefault(),History.pushState(null,Y,this.href)})}function c(e){var t=document.getElementById(e);!!(t&&t.dataset&&t.dataset.english)&&t.dataset.english;History.pushState(null,Y,N("campus",e))}function l(e){D(e||"h1, h2, h3, p, a, span, option").map(function(e){var t=e.dataset[ie];t&&(e.innerHTML=t)})}function r(){t(".logo-link").attr("href",K.website[ne]),t(".book-an-open-day").attr("href",K.book_an_open_day[ne]),t(".visit-our-courses").attr("href",K.visit_our_courses[ne]),t(".visit-our-website").attr("href",K.website[ne]),t(".smlo-facebook").attr("href",K.facebook[ne]),t(".smlo-twitter").attr("href",K.twitter[ne]),t(".smlo-instagram").attr("href",K.instagram[ne])}function d(i){t(".tile.inactive").removeClass("inactive");var n=!!i&&i.split("_"),a=!!n&&n[0],s=!!n&&n[1];e.studyLevel=a;var o={singleton:0,bay:0},c=!1,l=!(!a||!s)&&U[a].filter(function(e){var t=e.heading;return s===_(t[0])}).pop();if(l){e.activeFilterObj=l,e.filterSlug=!(!a||!l)&&i,l&&l.pins&&l.pins.map(function(e){var t=P(J,e);t&&t.map&&o[t.map]++});var r=!(!a||!l)&&("ug"===a?"Undergraduate":"pg"===a?"Postgraduate":"???"),d=!(!l||!l.heading)&&l.heading[0];t(".cat-title.default").hide(),t(".cat-title.dynamic").show(),t(".filter-label").text(d),r&&d&&(c=r+": "+d);var m="singleton";Object.keys(o).map(function(e){o[e]>o[m]&&(m=e)});var u=l&&l.main_campus?l.main_campus:m;t(".main-campus-box, .other-text").hide(),t("#"+u+"-main-campus-box").show();var p="bay"===u&&0!==o.singleton,h="singleton"===u&&0!==o.bay;(p||h)&&t("#"+u+"-main-campus-box .other-text").show(),t(".tile.select-"+u).addClass("hover"),0===o.singleton&&t(".tile.select-singleton").addClass("inactive"),0===o.bay&&t(".tile.select-bay").addClass("inactive")}else{e.filterSlug=!1,t(".main-campus-box, .main-campus-box .other-text").hide(),t(".filter-label").text(""),t(".cat-title.dynamic").hide(),t(".cat-title.default").show();var v="start"!==e.currentScreen&&"interest"!==e.currentScreen,g="all"!==e.activeFilterObj;v&&g?(c="No subject filter",e.activeFilterObj="all"):v||(e.activeFilterObj=!1)}for(var f=document.getElementsByClassName("historyjs-link"),w=0;w<f.length;w++){var b=f[w],y=A("s",b.href),C=A("g",b.href),L=A("c",b.href);b.href=N(y,i,C,L)}c&&window.dataLayer&&window.dataLayer.push({event:"subjectFilteredByOption",filterName:c})}function m(e){R(".touch-content-toggle","active"),R(".content-type-container","active"),M("#dl-"+e,"active"),M("#"+e+"-type-container","active")}function u(){J.map(function(e){if("accommodation"!==e.map&&e.content){var t="";e.position[0]>=50&&(t+=" ra-tooltip"),e.position[1]<=30&&(t+=" high-tooltip"),e.position[1]>=70&&(t+=" low-tooltip");var i="javascript:void(0)",n=e.cat.split("|"),a=n.map(function(e){return"pin-"+e}),s=a.join(" "),o=n.map(function(e){return"li-"+e}),c=o.join(" "),l=document.createElement("a");l.id="pin-"+e.id,l.className="map-pin disabled noselect map-content pin-content-link "+s,l.href=i,l.dataset.screen=e.map,l.dataset.pinId=e.id,l.style.left=e.position[0]+"%",l.style.top=e.position[1]+"%";var r=de[n[0]]?" icon-"+de[n[0]]:"",d="";d+='<svg class="icon map-pin-svg icon-'+r+'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29.79 42.36"><path class="cls-1" d="M29.79,16.08c0,10.6-14.9,26.28-14.9,26.28S0,26.68,0,16.08,6.67,0,14.89,0s14.9,5.48,14.9,16.08"></path><path class="cls-2" d="M26.32,15.1A11.42,11.42,0,1,1,14.89,3.68,11.42,11.42,0,0,1,26.32,15.1"></path>',d+='<g class="before">'+z[n[0]]+"</g>",d+='<g class="after">'+z[e.type?e.type:n[0]]+"</g>",d+="</svg>",l.innerHTML=d;var m=document.createElement("div");m.className="img",m.style.backgroundImage="url('img/tooltip/tt"+e.id+".jpg')";var u=document.createElement("h3");u.dataset.english=e.heading[0],u.dataset.cymraeg=e.heading[1];var p=document.createElement("p");p.dataset.english=e.text.desktop[0],p.dataset.cymraeg=e.text.desktop[1];var h=document.createElement("div");h.className="tt-text",h.appendChild(m),h.appendChild(u),h.appendChild(p);var v=document.createElement("span");v.className="prompt",v.dataset.english="Explore",v.dataset.cymraeg="Porwch";var g=document.createElement("a");g.id="pin-"+e.id+"-tt",g.className="map-pin-tt disabled map-content pin-content-link "+s+t,g.href=i,g.dataset.pinId=e.id,g.dataset.screen=e.map,g.style.left=e.position[0]+"%",g.style.top=e.position[1]+"%",g.appendChild(h),g.appendChild(v);var f=document.getElementById("map-"+e.map);if(f&&f.appendChild(l),f&&f.appendChild(g),!e.not_device){var w=document.createElement("div");w.className="img",w.style.backgroundImage="url('img/tooltip/tt"+e.id+".jpg')";var b=document.createElement("h3");b.dataset.english=e.heading[0],b.dataset.cymraeg=e.heading[1];var y=document.createElement("p");y.dataset.english=e.text.desktop[0],y.dataset.cymraeg=e.text.desktop[1];var C=document.createElement("div");C.className="tt-text",C.appendChild(w),C.appendChild(b),C.appendChild(y);var L=document.createElement("span");L.className="prompt",L.dataset.english="Explore",L.dataset.cymraeg="Porwch";var E=document.createElement("a");E.id="lv-"+e.id,E.className="device-list pin-content-link clearfix "+c,E.href=i,E.dataset.pinId=e.id,E.dataset.screen=e.map,E.style.left=e.position[0]+"%",E.style.top=e.position[1]+"%",E.appendChild(C),E.appendChild(L);var x=document.getElementById("list-"+e.map);x&&x.appendChild(E)}}}),q.map(function(e){t("#list-"+e.id+" .device-list.academic:even").addClass("even"),t("#list-"+e.id+" .device-list.campus:even").addClass("even"),t("#list-"+e.id+" .device-list.international:even").addClass("even"),t("#list-"+e.id+" .device-list.sport:even").addClass("even")}),D(".pin-content-link").map(function(e){e.addEventListener("click",p)}),D(".map-content").map(function(e){e.addEventListener("mouseenter",function(e){this.classList.contains("highlight")&&(this.classList.add("hover"),h(this.dataset.pinId))}),e.addEventListener("mouseleave",function(e){this.classList.remove("hover"),v(this.dataset.pinId)})})}function p(t){if(!(ce.width>Z)||this.classList.contains("highlight")){var i=P(J,parseInt(this.dataset.pinId));if(i&&i.content){var n=-1!==i.cat.indexOf("academic"),a=i.content,s=n&&e.filterSlug?e.filterSlug:"all",o=!1,c=a.tours,l=c&&c[s]?c[s]:[];!o&&l.length&&(o="tours_"+c[s][0]);var r=a.videos,d=r&&r[s]?r[s]:[];!o&&d.length&&(o="videos_"+r[s][0]);var m=a.vr,u=m&&m[s]?m[s]:[];if(!o&&u.length&&(o="vr_"+m[s][0]),!o){var p=e.activeFilterObj&&"all"!==e.activeFilterObj&&e.activeFilterObj.heading?e.activeFilterObj.heading[0]:"All";return void console.error('No 360, video, or VR content provided for the pin "'+i.heading[0]+'" for the filter "'+p+'".\nEither remove the pin from the filter, or add content using the key: "'+e.filterSlug+'"')}var h="?s="+this.dataset.screen;this.dataset.pinId&&(h+="&g="+this.dataset.pinId),o&&(h+="&c="+o),e.activeFilterObj&&e.studyLevel&&(h+="&f="+e.filterSlug),h+=se,History.pushState(null,Y,h)}}}function h(e){var t=(document.getElementById("pin-"+e),document.getElementById("pin-"+e+"-tt"));t.classList.contains("visible")||TweenLite.to(t,oe/2,{autoAlpha:1,scale:1,onComplete:function(){t.classList.add("visible")}})}function v(e){var t=document.getElementById("pin-"+e),i=document.getElementById("pin-"+e+"-tt"),n=t.classList.contains("hover"),a=i.classList.contains("hover");n||a||(i.classList.remove("visible"),TweenLite.to(i,oe,{autoAlpha:0,scale:.5}))}function g(e){if(!e.content)return!1;var t=w(e.cat,e.content.tours);f(t,"tours"),t||R("#dl-tours","visible");var i=w(e.cat,e.content.vr);f(i,"vr"),i||R("#dl-vr","visible");var n=w(e.cat,e.content.videos);f(n,"videos"),n||R("#dl-videos","visible"),l(".contentLink"),D(".contentLink").map(function(e){e.addEventListener("click",function(e){e.preventDefault(),j("hide"),History.pushState(null,Y,this.href)})})}function f(t,i){if(i){var n=document.getElementById(i+"-type-container");if(n){var a=document.getElementById(i+"-list");if(a){var s=document.getElementById("dl-"+i);if(s){var o=0;if(t){var c=!1;if("tours"===i&&(c=Q),"videos"===i&&(c=$),"vr"===i&&(c=G),!c)return;t.map(function(t){var n=P(c,t);if(n){o++;var s=document.createElement("a");s.id="list-"+i+"-"+n.id,s.className="contentLink",s.href=N(null,null,null,i+"_"+n.id),s.dataset.type=i,s.dataset.typeId=n.id,s.dataset.english="development"===e.environment?n.id+": "+n.heading[0]:n.heading[0],s.dataset.cymraeg="development"===e.environment?n.id+": "+n.heading[1]:n.heading[1];var l=document.createElement("li");l.appendChild(s),a.appendChild(l)}}),M("#dl-"+i,"visible")}o>5?(a.classList.add("two-col"),B(o.length)&&a.lastChild.classList.add("odd-list")):a.classList.remove("two-col"),o?(s.classList.remove("disabled"),n.classList.add("has-content"),M(".sidebar-content-"+i,"show")):(s.classList.add("disabled"),n.classList.remove("has-content"),R(".sidebar-content-"+i,"show"))}}}}}function w(t,i){if(!i)return!1;var n=!!t&&-1!==t.indexOf("academic"),a=n&&e.filterSlug?e.filterSlug:"all",s=a&&i[a]?i[a]:[];return!!s.length&&s}function b(i,n){var a=n.split("_")[0],s=parseInt(n.split("_")[1]),o=P(J,parseInt(i));o&&(e.contentOpenType!==a&&m(a),e.contentOpen?(e.contentOpenType===a&&"tours"===a?C(s):y(a,s,!0),t(".contentLink.active").removeClass("active")):(pe&&he&&(pe.map(function(e){e.dataset.english=o.heading[0],e.dataset.cymraeg=o.heading[1]}),he.map(function(e){e.dataset.english=o.text.sidepanel[0],e.dataset.cymraeg=o.text.sidepanel[1]}),l(".sidebar-title, .sidebar-text")),g(o),t("#tour-container").show(),y(a,s)),t("#list-"+a+"-"+s).addClass("active"),e.contentOpen=!0,e.contentOpenType=a,V())}function y(e,t,i){t=parseInt(t),i&&(me.innerHTML="");var n="tours"===e,a="videos"===e||"vr"===e,s=ce.width<=Z,o=!1;if(n&&(o=Q),a&&(o="videos"===e?$:G),o){var c=P(o,t);if(c){var l=document.createElement("iframe");l.id="content-iframe",l.frameborder=0,l.scrolling="no",l.setAttribute("allowfullscreen",!0),l.width="100%",l.height="100%",n&&(l.src="content/index.html?360="+t+"&iframeCleared=true&lang="+ne),a&&(l.src="https://www.youtube.com/embed/"+c.youtube_id[ne]+"?rel=0&modestbranding=1&playsinline=1'"),me.appendChild(l),s&&a&&window.open("http://www.youtube.com/watch/?v="+c.youtube_id[ne],"_blank")}}}function C(e){var t=document.getElementById("content-iframe");t&&void 0!==t.contentWindow.rv&&t.contentWindow.rv.loadScene(e)}function L(t){var i=e.setCategory?e.setCategory:"academic",n="academic"===i&&e.activeFilterObj&&"all"!==e.activeFilterObj;if(R(".side-nav li.active","active"),M(".side-nav-"+i,"active"),TweenLite.set(".map-pin-tt.highlight",{autoAlpha:0,clearProps:"opacity, visibility"}),R(".map-content.highlight","highlight"),M(".map-content.highlight","disabled"),n){D(".pin-"+i).map(function(t){var i=e.activeFilterObj.pins.filter(function(e){return t.dataset.pinId==e}),n=t.style.opacity>0;if(i.length){t.classList.contains("map-pin")&&TweenLite.to(t,oe,{autoAlpha:1}),t.classList.add("highlight"),t.classList.remove("disabled")}else n&&TweenLite.to(t,oe,{autoAlpha:0,clearProps:"opacity, visibility"})})}else M(".pin-"+i,"highlight"),R(".pin-"+i,"disabled"),e.activeFilterObj&&"all"!==e.activeFilterObj||TweenLite.to(".map-pin.pin-academic",oe,{autoAlpha:1});if(R(".device-list.device-show","device-show"),n){D(".li-"+i).map(function(t){e.activeFilterObj.pins.filter(function(e){return t.dataset.pinId==e}).length?t.classList.add("device-show"):t.classList.remove("device-show")})}else M(".li-"+i,"device-show");ue&&(ue.dataset.english=t.english,ue.dataset.cymraeg=t.cymraeg,l(".category-label"))}function E(){ce.width=t(window).width(),ce.height=t(window).height(),ce.width>Z?x():ce.width,t("#content-iframe").css({width:t("#iframe-container").width(),height:t("#iframe-container").height()}),ce.width>Z&&ee?(t("body").removeClass("small-viewport"),m("tours"),j("hide"),ee=!1):ce.width<=Z&&!ee&&(t("body").addClass("small-viewport"),ee=!0)}function x(){for(var e=0;e<q.length;e++){var i=q[e];if(void 0!==i.dimensions){var n=q[e].id,a={width:t("#campus-"+n).width(),height:t("#campus-"+n).height()},s=1.2*a.width,o=1.2*a.height,c=o*(i.dimensions[0]/i.dimensions[1]),l=s*(i.dimensions[1]/i.dimensions[0]);l<a.height?s=c:o=l;var r=.5*(a.width-s),d=.5*(a.height-o);void 0!==i.anchor&&("left"===i.anchor[0]?r=0:"right"===i.anchor[0]&&(r=a.width-s),"top"===i.anchor[1]?d=0:"bottom"===i.anchor[1]&&(d=a.height-o)),TweenLite.set("#map-"+n,{force3D:!0,width:s,height:o,x:r,y:d})}}}function j(e){var i=t("#sidebar"),n=t("#slideout-toggle");"hide"===e?(i.removeClass("show"),n.removeClass("back")):(i.toggleClass("show"),n.toggleClass("back"))}function I(){if(le){var i=e.studyLevel?e.studyLevel:"ug",n=K.explore_courses[i][ne],a=t("<iframe>").attr({class:"course-iframe",src:n,allowfullscreen:!0,scrolling:"yes"});t("#course-iframe-container").append(a),t("#iframe-newtab").attr("href",n),le.classList.add("show"),TweenLite.to("#iframe-window",oe,{opacity:1}),TweenLite.to(window,oe/2,{onComplete:function(){t("#iframe-window-hc").addClass("show")}}),e.iframeWindowVisible=!0}}function k(){le&&(TweenLite.to("#iframe-window",oe,{opacity:0,clearProps:"all",onComplete:function(){le.classList.remove("show"),t(".course-iframe").remove()}}),t("#iframe-window-hc").removeClass("show"),e.iframeWindowVisible=!1)}function O(){t("#whats-next").addClass("show"),TweenLite.to("#whats-next",oe,{opacity:1}),TweenLite.to(window,oe/2,{onComplete:function(){t("#wn-hc").addClass("show")}}),e.whatsNextVisible=!0}function S(){t("#wn-hc").removeClass("show"),TweenLite.to("#whats-next",oe,{opacity:0,clearProps:"all",onComplete:function(){t("#whats-next").removeClass("show")}}),e.whatsNextVisible=!1}function B(e){return e%2==1}function T(){t("#tour-container").hide(),t("#iframe-container, .content-type").empty(),e.contentOpen=!1,e.contentOpenType=!1}function V(){t(window).scrollTop(0)}function _(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/\/+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}function F(e){document.getElementById("tb-back").href=N(e,null)}function N(e,t,i,n){e=null===e?A("s"):e,t=null===t?A("f"):t,"interest"!==e&&"start"!==e||(t=!1),i=null===i?A("g"):i,n=null===n?A("c"):n;var a="";return a+=e?"?s="+e:"",a+=i?"&g="+i:"",a+=n?"&c="+n:"",a+=se,a+=t?"&f="+t:""}function A(e,t){t=t||window.location.search,e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=i.exec(t);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}function P(e,t,i){for(var n=0;n<e.length;n++)if(i){if(_(e[n].heading)===t)return e[n]}else if(e[n].id===t)return e[n];return!1}function H(){re&&(re.currentTime=0,re.play())}function W(){re&&(re.currentTime=0,re.pause())}function D(e){return Array.prototype.slice.call(document.querySelectorAll(e))}function M(e,t){D(e).map(function(e){return e.classList.add(t)})}function R(e,t){D(e).map(function(e){return e.classList.remove(t)})}var z=!1,q=!1,U=!1,J=!1,Q=!1,$=!1,G=!1,K=!1,X=!1,Y=document.title,Z=1024,ee=!1,te=!0,ie="cymraeg"===A("lang")?"cymraeg":"english",ne="cymraeg"===ie?1:0,ae="",se="",oe=.4,ce={width:t(window).width(),height:t(window).height()},le=document.getElementById("iframe-window"),re=document.getElementById("start-video-background"),de={academic:"mortar",campus:"city",international:"earth",sport:"tennis"},me=document.getElementById("iframe-container"),ue=document.querySelector(".category-label"),pe=D(".sidebar-title"),he=D(".sidebar-text");e.environment="production",e.dBowie="Heroes",e.setCategory=!1,e.beforeWhatsNext=!1,e.currentScreen=!1,e.contentOpen=!1,e.contentOpenType=!1,e.whatsNextVisible=!1,e.iframeWindowVisible=!1,e.activeFilterObj=!1,e.filterSlug=!1,e.start=function(){History.Adapter.bind(window,"statechange",s),window.addEventListener("resize",E),t.getJSON("ajax/vod.json",function(e){if(z=e.iconPaths,q=e.maps,U=e.filters,J=e.groups,Q=e.tours,$=e.videos,G=e.vr_videos,K=e.linkouts,X=e.text_strings,"cymraeg"===ie){Y="Taith Rithwir | Prifysgol Abertawe",document.title=Y,ae="?lang="+ie,se="&lang="+ie;for(var i=t(".historyjs-link"),a=0;a<i.length;a++){var c=t(i[a]),d=c.attr("href"),m=""===d?ae:d+se;c.attr("href",m)}}t("body").addClass(ie),n(),l(),r(),o(),s(),E(),TweenLite.to("body",oe,{opacity:1,delay:oe})})},function(e,t,i){i=i||window;var n=!1,a=function(){n||(n=!0,requestAnimationFrame(function(){i.dispatchEvent(new CustomEvent(t)),n=!1}))};i.addEventListener(e,a)}("resize","optimizedResize")}(window.vod=window.vod||{},jQuery);